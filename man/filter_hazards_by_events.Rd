% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils__filter_hazards_by_events.R
\name{filter_hazards_by_events}
\alias{filter_hazards_by_events}
\title{Filter hazard rasters to match event requirements}
\usage{
filter_hazards_by_events(hazards, events, hazards_inventory = NULL)
}
\arguments{
\item{hazards}{Named list of SpatRaster objects (from load_hazards_and_inventory())}

\item{events}{Data frame with event specifications including hazard_name column}

\item{hazards_inventory}{Optional. Hazard inventory for multi-indicator expansion. If NULL, assumes single-indicator only.}
}
\value{
Named list of filtered SpatRaster objects
}
\description{
Filters a list of hazard rasters to only those referenced by events.
For NC hazards, only the 'mean' ensemble is loaded by default, so filtering
matches the base hazard name without ensemble suffix.
For multi-indicator hazards (Fire), internally expands to load all required indicators.
}
\details{
Filter hazards by events with NC ensemble handling

The function handles two types of hazard filtering:

\strong{TIF hazards}: Exact name matching
\itemize{
\item If event specifies "flood__rcp85_h10glob", returns exactly that raster
}

\strong{NC hazards}: Base name matching
\itemize{
\item If event specifies "Drought__CDD__GWL=present__RP=5" (base event), returns the mean ensemble:
\itemize{
\item Drought__CDD__GWL=present__RP=5 (loaded as mean ensemble by default)
}
\item If event already specifies "__ensemble=mean", strips the ensemble suffix and matches base name
}

This simplified approach avoids loading multiple ensemble variants and focuses on
the mean ensemble as the representative value for each hazard scenario.
}
\examples{
\dontrun{
# Load hazards (gets NC hazards with mean ensemble only)
result <- load_hazards_and_inventory(hazards_dir, aggregate_factor = 1L)
hazards <- c(result$hazards$tif, result$hazards$nc)

# Define events (base event names without ensemble suffix)
events <- data.frame(
  hazard_name = c(
    "Drought__CDD__GWL=present__RP=5",
    "Compound__FWI__GWL=2__RP=10"
  ),
  event_year = c(2030, 2040)
)

# Filter: matches 2 events -> 2 hazard rasters (mean ensemble only)
filtered_hazards <- filter_hazards_by_events(hazards, events)
}
}
