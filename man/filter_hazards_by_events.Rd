% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils__filter_hazards_by_events.R
\name{filter_hazards_by_events}
\alias{filter_hazards_by_events}
\title{Filter hazard rasters to match event requirements}
\usage{
filter_hazards_by_events(hazards, events)
}
\arguments{
\item{hazards}{Named list of SpatRaster objects (from load_hazards_and_inventory())}

\item{events}{Data frame with event specifications including hazard_name column}
}
\value{
Named list of filtered SpatRaster objects
}
\description{
Filters a list of hazard rasters to only those referenced by events.
For NC hazards with ensemble dimensions, automatically expands to include ALL
ensemble variants (mean, median, p10, p90, etc.) to enable complete statistics
extraction.
}
\details{
Filter hazards by events with NC ensemble expansion

The function handles two types of hazard filtering:

\strong{TIF hazards}: Exact name matching
\itemize{
\item If event specifies "flood__rcp85_h10glob", returns exactly that raster
}

\strong{NC hazards}: Ensemble expansion
\itemize{
\item If event specifies "Drought__CDD__GWL=present__RP=5" (base event), returns ALL variants:
\itemize{
\item Drought__CDD__GWL=present__RP=5__ensemble=mean
\item Drought__CDD__GWL=present__RP=5__ensemble=median
\item Drought__CDD__GWL=present__RP=5__ensemble=p10
\item Drought__CDD__GWL=present__RP=5__ensemble=p90
}
\item If event already specifies "__ensemble=mean", still expands to ALL variants
}

This expansion ensures that the extraction function can populate all statistic
columns (hazard_mean, hazard_median, hazard_p10, hazard_p90, etc.) from the
pre-computed NC ensemble layers.
}
\examples{
\dontrun{
# Load hazards (gets 800 NC hazards with ensemble variants)
result <- load_hazards_and_inventory(hazards_dir, aggregate_factor = 1L)
hazards <- c(result$hazards$tif, result$hazards$nc)

# Define events (base event names without ensemble suffix)
events <- data.frame(
  hazard_name = c("Drought__CDD__GWL=present__RP=5",
                  "Compound__FWI__GWL=2__RP=10"),
  event_year = c(2030, 2040),
  chronic = c(FALSE, FALSE)
)

# Filter: expands 2 events -> 8 hazard rasters (2 Ã— 4 ensemble variants)
filtered_hazards <- filter_hazards_by_events(hazards, events)
}
}
