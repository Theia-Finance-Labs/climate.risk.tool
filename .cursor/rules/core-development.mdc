---
alwaysApply: true
description: Core development workflow, R package conventions, and documentation requirements
---

# Core Development Workflow

## R Package Structure & Conventions

This is an R package built with {golem} framework for Shiny apps. Follow these conventions strictly:

### Package Structure
- Main package files: [DESCRIPTION](mdc:DESCRIPTION), [NAMESPACE](mdc:NAMESPACE)
- R functions go in [R/](mdc:R/) directory
- Tests go in [tests/testthat/](mdc:tests/testthat/)
- Documentation in [man/](mdc:man/) (auto-generated by devtools - DO NOT edit manually)
- Working document: [CONTEXT.md](mdc:CONTEXT.md)

### Documentation Requirements
- Every exported function MUST have roxygen2 documentation with @title, @description, @param, @return, @examples
- Use @noRd for internal functions
- Run `devtools::document()` after adding new functions to auto-generate [man/](mdc:man/) files
- NEVER manually edit files in [man/](mdc:man/) - they are auto-generated

### NAMESPACE Management
- NEVER edit [NAMESPACE](mdc:NAMESPACE) manually - it's auto-generated
- Use roxygen2 tags (@export) to manage exports
- NEVER use @importFrom - always use `pkg::function()` notation in code instead

### DESCRIPTION File
- Keep [DESCRIPTION](mdc:DESCRIPTION) updated with new dependencies
- Use Imports: for required packages, Suggests: for optional ones
- Maintain proper version constraints

## Development Commands

### Running the Application
- **Use `golem::run_dev()` to run the Shiny app in development mode**
- This automatically reloads changes and provides debugging tools
- Never use `shiny::runApp()` directly

### Testing Commands
- **Use `devtools::test()` to run all tests**
- Use `devtools::test_file("tests/testthat/test-function_name.R")` for specific tests
- Use `devtools::load_all()` to load package changes without restarting R

### Package Development
- Use `devtools::document()` to update documentation and NAMESPACE
- Use `devtools::check()` to run full package checks
- Use `devtools::install()` to install the package locally

## File Organization
- Business logic functions go in [R/](mdc:R/) directory
- Tests go in [tests/testthat/](mdc:tests/testthat/)
- Test data goes in [tests/tests_data/](mdc:tests/tests_data/)
- Keep [CONTEXT.md](mdc:CONTEXT.md) updated

## Climate Risk Pipeline
- Follow the 16-step pipeline documented in [CONTEXT.md](mdc:CONTEXT.md)
- Each step should be a separate, testable function
- Use the function contracts as specifications for TDD

## Working Document Requirements
- **ALWAYS update [CONTEXT.md](mdc:CONTEXT.md) when adding new functions or tests**
- Document new functions in the "Function contracts" section
- Update test strategy if needed
- Log any architectural decisions or changes

### Documentation Format
- Add new functions with their signatures: `function_name(params) -> return_type`
- Include brief description of what the function does
- Update the high-level pipeline if workflow changes
- Note any open questions or decisions needed

### Pipeline Documentation
- Keep the 16-step pipeline in [CONTEXT.md](mdc:CONTEXT.md) current
- Document data flow between functions
- Note any placeholder functions that need implementation

### Test Documentation
- Update testing strategy when adding new test patterns
- Document any new test data requirements
- Note any testing challenges or solutions